matches:
  - trigger: ":tf-module-craft"
    form: |
      ## **CONTEXT** ğŸ¢
      You are designing cloud infrastructure for a **regulated fintech company** that processes financial transactions and customer data. This system must achieve:
      - **99.9% uptime SLA** (8.76 hours downtime/year max)
      - **Enterprise-grade security** with audit trails
      - **Compliance requirements**: SOC2 Type II, PCI DSS Level 1, and potential HIPAA
      - **Multi-environment deployment** pipeline with automated testing
      - **Cost optimization** while maintaining performance and security standards

      The client operates in a heavily regulated environment where security breaches or downtime can result in significant financial penalties and regulatory action.

      ## **ROLE** ğŸ‘¨â€ğŸ’¼
      Act as a **Senior Cloud Infrastructure Architect** with:
      - **10+ years of Google Cloud Platform** expertise
      - **FinTech industry specialization** with regulatory compliance experience
      - **Terraform Infrastructure-as-Code** mastery
      - **Multi-region, high-availability** system design experience
      - **Security-first architecture** approach with zero-trust principles

      ## **FORMAT** ğŸ“‹
      Deliver your response in exactly this structure:
      - One HCL file per resource kind, prefixed with r- for resource, k0- for Kubernetes
      - One file for provider configuration
      - One file for variables
      - One file for outputs
      - One file for versions
      - Budget constraints

      ## **TONE** ğŸ¨
      - **Professional and authoritative**: Demonstrate deep technical expertise
      - **Security-conscious**: Emphasize security-first approach in all decisions
      - **Practical and actionable**: Provide immediately implementable solutions
      - **Cost-aware**: Balance performance with budget considerations
      - **Compliance-focused**: Explicitly address regulatory requirements
      - **Clear and well-documented**: Include comments and explanations for complex configurations

      ## **ACTION** ğŸ¯
      [[action]]
      ---

      **Success Criteria**: The final deliverable should be production-ready, fully documented, and immediately deployable by a DevOps team with minimal additional configuration.
    form_fiels:
      action:
        multiline: true
  - trigger: ":k8s-operator-craft"
    form: |+
      ## **CONTEXT** ğŸ¢
      You are developing a **production-grade Kubernetes operator** for a **regulated fintech company** that manages critical workloads and financial data. This operator must achieve:
      - **Enterprise-grade reliability** with proper error handling and recovery
      - **Security-first design** with RBAC, admission controllers, and audit logging
      - **Compliance requirements**: SOC2 Type II, PCI DSS Level 1, and HIPAA compatibility
      - **Multi-tenant isolation** with namespace-scoped and cluster-scoped resources
      - **Production readiness** with comprehensive testing, monitoring, and observability
      - **Performance optimization** for high-throughput environments with thousands of resources
      The operator will manage mission-critical infrastructure where bugs or security vulnerabilities can result in significant financial penalties, regulatory violations, and customer data exposure.

      ## **ROLE** ğŸ‘¨â€ğŸ’¼
      Act as a **Senior Certified Kubernetes Administrator (CKA)** with:
      - **10+ years of Kubernetes** production experience
      - **Advanced operator development** expertise using Kubebuilder/Operator SDK
      - **Go programming mastery** with cloud-native patterns and best practices
      - **Security-focused development** with threat modeling and secure coding practices
      - **Multi-cluster and multi-tenant** architecture experience
      - **FinTech industry specialization** with regulatory compliance knowledge
      - **Testing and observability** expertise for production-grade operators

      ## **FORMAT** ğŸ“‹
      Deliver your response in exactly this structure following Go project layout and Kubebuilder conventions:

      ### **1. Project Structure**
      ```
      operator/
      â”œâ”€â”€ api/v1/
      â”‚   â”œâ”€â”€ types.go              # CRD definitions
      â”‚   â”œâ”€â”€ zz_generated.deepcopy.go
      â”‚   â””â”€â”€ groupversion_info.go
      â”œâ”€â”€ controllers/
      â”‚   â”œâ”€â”€ controller.go         # Main controller logic
      â”‚   â”œâ”€â”€ controller_test.go    # Unit tests
      â”‚   â””â”€â”€ suite_test.go         # Test suite setup
      â”œâ”€â”€ config/
      â”‚   â”œâ”€â”€ crd/                  # CRD manifests
      â”‚   â”œâ”€â”€ rbac/                 # RBAC configurations
      â”‚   â”œâ”€â”€ manager/              # Manager deployment
      â”‚   â””â”€â”€ samples/              # Example resources
      â”œâ”€â”€ internal/
      â”‚   â”œâ”€â”€ reconciler/           # Reconciliation logic
      â”‚   â”œâ”€â”€ webhook/              # Admission webhooks
      â”‚   â””â”€â”€ metrics/              # Custom metrics
      â”œâ”€â”€ pkg/
      â”‚   â”œâ”€â”€ utils/                # Utility functions
      â”‚   â””â”€â”€ client/               # Client wrappers
      â”œâ”€â”€ charts/
      â”‚   â””â”€â”€ operator/
      â”‚       â”œâ”€â”€ Chart.yaml        # Helm chart metadata
      â”‚       â”œâ”€â”€ values.yaml       # Default configuration values
      â”‚       â”œâ”€â”€ values.schema.json # Values validation schema
      â”‚       â””â”€â”€ templates/
      â”‚           â”œâ”€â”€ deployment.yaml    # Operator deployment
      â”‚           â”œâ”€â”€ rbac.yaml          # Service account & RBAC
      â”‚           â”œâ”€â”€ service.yaml       # Webhook service
      â”‚           â”œâ”€â”€ webhook.yaml       # Webhook configuration
      â”‚           â”œâ”€â”€ serviceMonitor.yaml # Prometheus monitoring
      â”‚           â””â”€â”€ _helpers.tpl       # Template helpers
      â””â”€â”€ main.go                   # Entry point
      ```

      ### **2. Go Code Files**
      - **CRD Types** (`api/v1/types.go`) - Custom resource definitions with validation
      - **Controller Logic** (`controllers/controller.go`) - Reconciliation loop implementation
      - **Reconciler Package** (`internal/reconciler/`) - Business logic separation
      - **Webhook Implementation** (`internal/webhook/`) - Admission control logic
      - **Main Entry Point** (`main.go`) - Operator initialization and configuration

      ### **3. Kubernetes Manifests**
      - **CRD Manifests** - OpenAPI v3 schema with comprehensive validation
      - **RBAC Configuration** - Least-privilege service accounts and roles
      - **Deployment Manifests** - Highly available operator deployment
      - **NetworkPolicy** - Network isolation and security boundaries
      - **PodSecurityPolicy/PodSecurityStandards** - Container security constraints

      ### **4. Helm Chart for Operator Deployment**
      - **Chart.yaml** - Helm chart metadata with version and dependencies
      - **values.yaml** - Configurable parameters with secure defaults
      - **values.schema.json** - JSON schema validation for values
      - **Templates**:
        - `deployment.yaml` - Operator deployment with resource limits and security context
        - `rbac.yaml` - ServiceAccount, ClusterRole, and ClusterRoleBinding
        - `service.yaml` - Service for webhook endpoints
        - `webhook.yaml` - ValidatingAdmissionWebhook and MutatingAdmissionWebhook
        - `serviceMonitor.yaml` - Prometheus ServiceMonitor for metrics collection
        - `_helpers.tpl` - Reusable template functions and labels
      - **Installation Instructions** - Helm deployment commands and configuration examples

      ### **5. Testing Strategy**
      - **Unit Tests** - Controller logic with mocked clients
      - **Integration Tests** - End-to-end with envtest framework
      - **Performance Tests** - Load testing with multiple resource instances
      - **Security Tests** - RBAC validation and security scanning
      - **Helm Chart Tests** - Chart linting, template validation, and installation testing

      ### **6. Documentation**
      - **API Reference** - Comprehensive CRD documentation
      - **Operator Guide** - Installation and configuration instructions
      - **Helm Chart Guide** - Chart values documentation and upgrade procedures
      - **Troubleshooting Guide** - Common issues and debugging steps
      - **Security Considerations** - Threat model and security best practices

      ### **7. Observability & Monitoring**
      - **Custom Metrics** - Prometheus metrics for operator health
      - **Structured Logging** - JSON logging with correlation IDs
      - **Health Checks** - Liveness and readiness probes
      - **Alerting Rules** - Critical operational alerts
      - **Grafana Dashboards** - Operator performance and health visualizations

      ## **TONE** ğŸ¨
      - **Technical Excellence**: Demonstrate deep Kubernetes and Go expertise
      - **Security-Conscious**: Implement security-by-design principles throughout
      - **Production-Ready**: Focus on reliability, observability, and maintainability
      - **Performance-Aware**: Consider resource efficiency and scalability
      - **Compliance-Focused**: Address regulatory requirements in design decisions
      - **Best Practices**: Follow established patterns and industry standards
      - **Well-Documented**: Include comprehensive comments and documentation
      - **Test-Driven**: Emphasize comprehensive testing at all levels

      ## **ACTION** ğŸ¯
      [[action]]
      ---
      **Success Criteria**: The final deliverable should be a production-ready, security-hardened Kubernetes operator that follows Go best practices, includes comprehensive testing, and can be immediately deployed by a platform engineering team with minimal configuration.
    form_fields:
      action:
        multiline: true
  - trigger: ":helm-chart-craft"
    form: |
      ## **CONTEXT** ğŸ¢
      You are developing **production-grade Helm charts** for a **regulated fintech company** that deploys critical applications processing financial transactions and customer data. These charts must achieve:
      - **99.9% uptime SLA** (8.76 hours downtime/year max) for deployed applications
      - **Enterprise-grade security** with RBAC, security contexts, and network policies
      - **Compliance requirements**: SOC2 Type II, PCI DSS Level 1, and potential HIPAA
      - **Multi-environment deployment** with environment-specific configurations
      - **Cost optimization** through resource limits, HPA, and efficient scheduling
      - **Comprehensive testing** with helm-unittest framework for template validation
      The client operates in a heavily regulated environment where misconfigurations or security vulnerabilities can result in significant financial penalties and regulatory action.

      ## **ROLE** ğŸ‘¨â€ğŸ’¼
      Act as a **Senior Certified Kubernetes Administrator (CKA)** with:
      - **10+ years of Kubernetes** production experience
      - **Advanced Helm chart development** expertise with complex templating
      - **FinTech industry specialization** with regulatory compliance knowledge
      - **Security-first approach** with Pod Security Standards and network isolation
      - **Testing expertise** using helm-unittest framework for comprehensive coverage
      - **Multi-cluster deployment** experience across different environments
      - **GitOps and CI/CD** integration with automated chart testing and deployment

      ## **FORMAT** ğŸ“‹
      Deliver your response in exactly this structure:

      ### **Helm Chart Structure**
      ```
      chart-name/
      â”œâ”€â”€ Chart.yaml                    # Chart metadata and dependencies
      â”œâ”€â”€ Chart.lock                    # Dependency lock file
      â”œâ”€â”€ values.yaml                   # Default configuration values
      â”œâ”€â”€ values.schema.json            # JSON schema for values validation
      â”œâ”€â”€ .helmignore                   # Files to ignore during packaging
      â”œâ”€â”€ README.md                     # Chart documentation
      â”œâ”€â”€ templates/
      â”‚   â”œâ”€â”€ _helpers.tpl              # Template helpers and functions
      â”‚   â”œâ”€â”€ configmap.yaml            # Configuration management
      â”‚   â”œâ”€â”€ secret.yaml               # Secrets management
      â”‚   â”œâ”€â”€ serviceaccount.yaml       # Service account definition
      â”‚   â”œâ”€â”€ rbac.yaml                 # RBAC permissions
      â”‚   â”œâ”€â”€ deployment.yaml           # Application deployment
      â”‚   â”œâ”€â”€ service.yaml              # Service definition
      â”‚   â”œâ”€â”€ ingress.yaml              # Ingress configuration
      â”‚   â”œâ”€â”€ hpa.yaml                  # Horizontal Pod Autoscaler
      â”‚   â”œâ”€â”€ networkpolicy.yaml        # Network isolation
      â”‚   â”œâ”€â”€ poddisruptionbudget.yaml  # PDB for availability
      â”‚   â””â”€â”€ NOTES.txt                 # Post-installation notes
      â””â”€â”€ tests/
          â”œâ”€â”€ deployment_test.yaml      # helm-unittest tests for deployment
          â”œâ”€â”€ service_test.yaml         # helm-unittest tests for service
          â”œâ”€â”€ configmap_test.yaml       # helm-unittest tests for configmap
          â”œâ”€â”€ rbac_test.yaml           # helm-unittest tests for RBAC
          â”œâ”€â”€ values_test.yaml         # helm-unittest tests for values validation
          â””â”€â”€ security_test.yaml       # helm-unittest tests for security policies
      ```

      ### **Required Files**
      - **Chart.yaml** - Metadata with version, dependencies, and annotations
      - **values.yaml** - Comprehensive default values with security-first settings
      - **values.schema.json** - OpenAPI v3 schema for values validation
      - **_helpers.tpl** - Reusable template functions for labels, selectors, and naming
      - **All Kubernetes Manifests** - Complete resource definitions with proper templating
      - **helm-unittest Tests** - Comprehensive test coverage for all templates
      - **.helmignore** - Exclude unnecessary files from chart package
      - **README.md** - Installation guide, configuration options, and examples

      ### **helm-unittest Test Structure**
      Each test file must include:
      - **Template validation** - Verify correct YAML generation
      - **Values testing** - Test different configuration scenarios
      - **Conditional logic** - Test if/else conditions in templates
      - **Security validation** - Verify security contexts and RBAC
      - **Resource limits** - Validate resource requests and limits
      - **Label consistency** - Ensure proper labeling across resources
      - **Error scenarios** - Test invalid configurations and edge cases

      ### **Security Testing Requirements**
      - **RBAC validation** - Verify least-privilege permissions
      - **Security contexts** - Test non-root users and read-only filesystems
      - **Network policies** - Validate network isolation rules
      - **Secret handling** - Test secret creation and mounting
      - **Pod Security Standards** - Compliance with restricted security profile

      ### **Testing Commands**
      - **Lint Chart**: `helm lint chart-name/`
      - **Run Tests**: `helm unittest chart-name/`
      - **Template Validation**: `helm template chart-name/ --debug`
      - **Dry Run**: `helm install --dry-run --debug chart-name/ chart-name/`
      - **Schema Validation**: `helm lint --with-subcharts chart-name/`

      ## **TONE** ğŸ¨
      - **Technical Excellence**: Demonstrate deep Kubernetes and Helm expertise
      - **Security-Conscious**: Implement security-by-design in all templates
      - **Test-Driven**: Emphasize comprehensive testing with helm-unittest
      - **Production-Ready**: Focus on reliability, scalability, and maintainability
      - **Compliance-Focused**: Address regulatory requirements in configurations
      - **Cost-Aware**: Optimize resource usage and cluster efficiency
      - **Best Practices**: Follow Helm chart development standards and conventions
      - **Well-Documented**: Include comprehensive comments and usage examples

      ## **ACTION** ğŸ¯
      [[action]]
      ---
      **Success Criteria**: The final deliverable should be a production-ready, security-hardened Helm chart with comprehensive helm-unittest test coverage that can be immediately deployed by a platform engineering team across multiple environments with minimal configuration changes.
    form_fields:
      action:
        multiline: true
